<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Decontamination of ambient RNA in single-cell genomic data with DecontX • celda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Decontamination of ambient RNA in single-cell genomic data with DecontX">
<meta property="og:description" content="celda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">celda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://www.camplab.net/celda" class="external-link">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/articles/celda_pbmc3k.html">Celda - Analysis of PBMC3K</a>
    </li>
    <li>
      <a href="../articles/articles/decontX_pbmc4k.html">DecontX - Decontamination of PBMC4K</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/campbio/celda" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/campbio/celda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Decontamination of ambient RNA in single-cell
genomic data with DecontX</h1>
                        <h4 data-toc-skip class="author">Shiyi (Iris)
Yang</h4>
            <address class="author_afil">
      Boston University School of
Medicine<br><h4 data-toc-skip class="author">Zhe
Wang</h4>
            <address class="author_afil">
      Boston University School of
Medicine<br><h4 data-toc-skip class="author">Yuan
Yin</h4>
            <address class="author_afil">
      Boston University School of
Medicine<br><h4 data-toc-skip class="author">Joshua
Campbell</h4>
            <address class="author_afil">
      Boston University School of
Medicine<br><a class="author_email" href="mailto:#"></a><a href="mailto:camp@bu.edu" class="email">camp@bu.edu</a>
      </address>
                  
            <h4 data-toc-skip class="date">2022-10-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/campbio/celda/blob/HEAD/vignettes/decontX.Rmd" class="external-link"><code>vignettes/decontX.Rmd</code></a></small>
      <div class="hidden name"><code>decontX.Rmd</code></div>

    </address>
</address>
</address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Droplet-based microfluidic devices have become widely used to perform
single-cell RNA sequencing (scRNA-seq). However, ambient RNA present in
the cell suspension can be aberrantly counted along with a cell’s native
mRNA and result in cross-contamination of transcripts between different
cell populations. DecontX is a Bayesian method to estimate and remove
contamination in individual cells. DecontX assumes the observed
expression of a cell is a mixture of counts from two multinomial
distributions: (1) a distribution of native transcript counts from the
cell’s actual population and (2) a distribution of contaminating
transcript counts from all other cell populations captured in the assay.
Overall, computational decontamination of single cell counts can aid in
downstream clustering and visualization.</p>
<p>The package can be loaded using the <code>library</code> command.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">celda</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'IRanges' was built under R version 4.2.1</span></span></code></pre>
<pre><code><span><span class="co">## Warning: package 'GenomeInfoDb' was built under R version 4.2.1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="importing-data">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<p>DecontX can take either a <a href="https://bioconductor.org/packages/release/bioc/html/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a>
object or a counts matrix as input. <code>decontX</code> will attempt to
convert any input matrix to class <code>dgCMatrix</code> from package <a href="https://cran.r-project.org/web/packages/Matrix/index.html" class="external-link">Matrix</a>
before starting the analysis.</p>
<p>To import datasets directly into an SCE object, the <a href="https://bioconductor.org/packages/release/bioc/html/singleCellTK.html" class="external-link">singleCellTK</a>
package has several importing functions for different preprocessing
tools including CellRanger, STARsolo, BUStools, Optimus, DropEST, SEQC,
and Alevin/Salmon. For example, the following code can be used as a
template to read in the filtered and raw matrices for multiple samples
processed with CellRanger:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.camplab.net/sctk/" class="external-link">singleCellTK</a></span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/singleCellTK/man/importCellRanger.html" class="external-link">importCellRanger</a></span><span class="op">(</span>sampleDirs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"path/to/sample1/"</span>, <span class="st">"path/to/sample2/"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Within each sample directory, there should be subfolders called
<code>"outs/filtered_feature_bc_matrix/"</code> or
<code>"outs/raw_feature_bc_matrix/"</code> with files called
<code>matrix.mtx.gz</code>, <code>features.tsv.gz</code> and
<code>barcodes.tsv.gz</code>. If these files are in different
subdirectories, the <code>importCellRangerV3Sample</code> function can
be used to import data from a different directory instead.</p>
<p>Optionally, the “raw” or “droplet” matrix can also be easily imported
by setting the <code>dataType</code> argument to “raw”:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce.raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/singleCellTK/man/importCellRanger.html" class="external-link">importCellRanger</a></span><span class="op">(</span>sampleDirs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"path/to/sample1/"</span>, <span class="st">"path/to/sample2/"</span><span class="op">)</span>, dataType <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span></code></pre></div>
<p>The raw matrix can be passed to the <code>background</code> parameter
in <code>decontX</code> as described below. If using Seurat, go to the
<a href="#seurat">Working with Seurat</a> section for details on how to
convert between SCE and Seurat objects.</p>
</div>
<div class="section level2">
<h2 id="load-pbmc4k-data-from-10x">Load PBMC4k data from 10X<a class="anchor" aria-label="anchor" href="#load-pbmc4k-data-from-10x"></a>
</h2>
<p>We will utilize the 10X PBMC 4K dataset as an example in this
vignette. This data can be easily retrieved from the package <a href="http://bioconductor.org/packages/release/data/experiment/html/TENxPBMCData.html" class="external-link">TENxPBMCData</a>.
Make sure the the column names are set before running decontX.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load PBMC data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TENxPBMCData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'HDF5Array' was built under R version 4.2.1</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TENxPBMCData/man/TENxPBMCData.html" class="external-link">TENxPBMCData</a></span><span class="op">(</span><span class="st">"pbmc4k"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">sce</span><span class="op">$</span><span class="va">Sample</span>, <span class="va">sce</span><span class="op">$</span><span class="va">Barcode</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">$</span><span class="va">Symbol_TENx</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>, <span class="st">"dgCMatrix"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-decontx">Running decontX<a class="anchor" aria-label="anchor" href="#running-decontx"></a>
</h2>
<p>A SingleCellExperiment (SCE) object or a sparse matrix containing the
counts for filtered cells can be passed to decontX via the
<code>x</code> parameter. The matrix to use in an SCE object can be
specified with the <code>assayName</code> parameter, which is set to
<code>"counts"</code> by default. There are two major ways to run
decontX: with and without the raw/droplet matrix containing empty
droplets. Here is an example of running decontX without supplying the
background:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decontX.html">decontX</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></code></pre></div>
<p>In this scenario, <code>decontX</code> will estimate the
contamination distribution for each cell cluster based on the profiles
of the other cell clusters in the filtered dataset. The estimated
contamination results can be found in the
<code>colData(sce)$decontX_contamination</code> and the decontaminated
counts can be accessed with <code>decontXcounts(sce)</code>.
<code>decontX</code> will perform heuristic clustering to quickly define
major cell clusters. However if you have your own cell cluster labels,
they can be specified with the <code>z</code> parameter. These results
will be used throughout the rest of the vignette.</p>
<p>The raw/droplet matrix can be used to empirically estimate the
distribution of ambient RNA, which is especially useful when cells that
contributed to the ambient RNA are not accurately represented in the
filtered count matrix containing the cells. For example, cells that were
removed via flow cytometry or that were more sensitive to lysis during
dissociation may have contributed to the ambient RNA but were not
measured in the filtered/cell matrix. The raw/droplet matrix can be
input as an SCE object or a sparse matrix using the
<code>background</code> parameter:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decontX.html">decontX</a></span><span class="op">(</span><span class="va">sce</span>, background <span class="op">=</span> <span class="va">sce.raw</span><span class="op">)</span></span></code></pre></div>
<p>Only empty droplets in the background matrix should be used to
estimate the ambient RNA. If any cell ids (i.e. <code>colnames</code>)
in the raw/droplet matrix supplied to the <code>background</code>
parameter are also found in the filtered counts matrix (<code>x</code>),
decontX will automatically remove them from the raw matrix. However, if
the cell ids are not available for the input matrices, decontX will
treat the entire <code>background</code> input as empty droplets. All of
the outputs are the same as when running decontX without setting the
<code>background</code> parameter.</p>
<blockquote>
<p>Note: If the input object is just a matrix and not an SCE object,
make sure to save the output into a variable with a different name
(e.g. <code>result &lt;- decontX(mat)</code>). The result object will be
a list with contamination in <code>result$contamination</code> and the
decontaminated counts in <code>result$decontXcounts</code>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="plotting-decontx-results">Plotting DecontX results<a class="anchor" aria-label="anchor" href="#plotting-decontx-results"></a>
</h2>
<div class="section level3">
<h3 id="cluster-labels-on-umap">Cluster labels on UMAP<a class="anchor" aria-label="anchor" href="#cluster-labels-on-umap"></a>
</h3>
<p>DecontX creates a UMAP which we can use to plot the cluster labels
automatically identified in the analysis. Note that the clustering
approach used here is designed to find “broad” cell types rather than
individual cell subpopulations within a cell type.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html" class="external-link">reducedDim</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"decontX_UMAP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotDimReduceCluster.html">plotDimReduceCluster</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sce</span><span class="op">$</span><span class="va">decontX_clusters</span>,</span>
<span>    dim1 <span class="op">=</span> <span class="va">umap</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, dim2 <span class="op">=</span> <span class="va">umap</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/UMAP_Clusters-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="contamination-on-umap">Contamination on UMAP<a class="anchor" aria-label="anchor" href="#contamination-on-umap"></a>
</h3>
<p>The percentage of contamination in each cell can be plotting on the
UMAP to visualize what what clusters may have higher levels of ambient
RNA.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDecontXContamination.html">plotDecontXContamination</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/plot_decon-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="expression-of-markers-on-umap">Expression of markers on UMAP<a class="anchor" aria-label="anchor" href="#expression-of-markers-on-umap"></a>
</h3>
<p>Known marker genes can also be plotted on the UMAP to identify the
cell types for each cluster. We will use CD3D and CD3E for T-cells, LYZ,
S100A8, and S100A9 for monocytes, CD79A, CD79B, and MS4A1 for B-cells,
GNLY for NK-cells, and PPBP for megakaryocytes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'scuttle' was built under R version 4.2.1</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">logNormCounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotDimReduceFeature.html">plotDimReduceFeature</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">logcounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    dim1 <span class="op">=</span> <span class="va">umap</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>    dim2 <span class="op">=</span> <span class="va">umap</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>    features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD3D"</span>, <span class="st">"CD3E"</span>, <span class="st">"GNLY"</span>,</span>
<span>        <span class="st">"LYZ"</span>, <span class="st">"S100A8"</span>, <span class="st">"S100A9"</span>,</span>
<span>        <span class="st">"CD79A"</span>, <span class="st">"CD79B"</span>, <span class="st">"MS4A1"</span><span class="op">)</span>,</span>
<span>    exactMatch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/plot_feature-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="barplot-of-markers-detected-in-cell-clusters">Barplot of markers detected in cell clusters<a class="anchor" aria-label="anchor" href="#barplot-of-markers-detected-in-cell-clusters"></a>
</h3>
<p>The percetage of cells within a cluster that have detectable
expression of marker genes can be displayed in a barplot. Markers for
cell types need to be supplied in a named list. First, the detection of
marker genes in the original <code>counts</code> assay is shown:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Tcell_Markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD3E"</span>, <span class="st">"CD3D"</span><span class="op">)</span>,</span>
<span>    Bcell_Markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD79A"</span>, <span class="st">"CD79B"</span>, <span class="st">"MS4A1"</span><span class="op">)</span>,</span>
<span>    Monocyte_Markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S100A8"</span>, <span class="st">"S100A9"</span>, <span class="st">"LYZ"</span><span class="op">)</span>,</span>
<span>    NKcell_Markers <span class="op">=</span> <span class="st">"GNLY"</span><span class="op">)</span></span>
<span><span class="va">cellTypeMappings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Tcells <span class="op">=</span> <span class="fl">2</span>, Bcells <span class="op">=</span> <span class="fl">5</span>, Monocytes <span class="op">=</span> <span class="fl">1</span>, NKcells <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotDecontXMarkerPercentage.html">plotDecontXMarkerPercentage</a></span><span class="op">(</span><span class="va">sce</span>,</span>
<span>    markers <span class="op">=</span> <span class="va">markers</span>,</span>
<span>    groupClusters <span class="op">=</span> <span class="va">cellTypeMappings</span>,</span>
<span>    assayName <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/barplotCounts-1.png" width="700"></p>
<p>We can then look to see how much decontX removed aberrant expression
of marker genes in each cell type by changing the <code>assayName</code>
to <code>decontXcounts</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDecontXMarkerPercentage.html">plotDecontXMarkerPercentage</a></span><span class="op">(</span><span class="va">sce</span>,</span>
<span>    markers <span class="op">=</span> <span class="va">markers</span>,</span>
<span>    groupClusters <span class="op">=</span> <span class="va">cellTypeMappings</span>,</span>
<span>    assayName <span class="op">=</span> <span class="st">"decontXcounts"</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/barplotDecontCounts-1.png" width="700"></p>
<p>Percentages of marker genes detected in other cell types were reduced
or completely removed. For example, the percentage of cells that
expressed Monocyte marker genes was greatly reduced in T-cells, B-cells,
and NK-cells. The original counts and decontamined counts can be plotted
side-by-side by listing multiple assays in the <code>assayName</code>
parameter. This option is only available if the data is stored in
<code>SingleCellExperiment</code> object.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDecontXMarkerPercentage.html">plotDecontXMarkerPercentage</a></span><span class="op">(</span><span class="va">sce</span>,</span>
<span>    markers <span class="op">=</span> <span class="va">markers</span>,</span>
<span>    groupClusters <span class="op">=</span> <span class="va">cellTypeMappings</span>,</span>
<span>    assayName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"counts"</span>, <span class="st">"decontXcounts"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/barplotBoth-1.png" width="700"></p>
<p>Some helpful hints when using
<code>plotDecontXMarkerPercentage</code>:</p>
<ol style="list-style-type: decimal">
<li>Cell clusters can be renamed and re-grouped using the
<code>groupCluster</code> parameter, which also needs to be a named
list. If <code>groupCluster</code> is used, cell clusters not included
in the list will be excluded in the barplot. For example, if we wanted
to group T-cells and NK-cells together, we could set
<code>cellTypeMappings &lt;- list(NK_Tcells = c(2,6), Bcells = 5, Monocytes = 1)</code>
</li>
<li>The level a gene that needs to be expressed to be considered
detected in a cell can be adjusted using the <code>threshold</code>
parameter.</li>
<li>If you are not using a <code>SingleCellExperiment</code>, then you
will need to supply the original counts matrix or the decontaminated
counts matrix as the first argument to generate the barplots.</li>
</ol>
</div>
<div class="section level3">
<h3 id="violin-plot-to-compare-the-distributions-of-original-and-decontaminated-counts">Violin plot to compare the distributions of original and
decontaminated counts<a class="anchor" aria-label="anchor" href="#violin-plot-to-compare-the-distributions-of-original-and-decontaminated-counts"></a>
</h3>
<p>Another useful way to assess the amount of decontamination is to view
the expression of marker genes before and after <code>decontX</code>
across cell types. Here we view the monocyte markers in each cell type.
The violin plot shows that the markers have been removed from T-cells,
B-cells, and NK-cells, but are largely unaffected in monocytes.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDecontXMarkerExpression.html">plotDecontXMarkerExpression</a></span><span class="op">(</span><span class="va">sce</span>,</span>
<span>    markers <span class="op">=</span> <span class="va">markers</span><span class="op">[[</span><span class="st">"Monocyte_Markers"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    groupClusters <span class="op">=</span> <span class="va">cellTypeMappings</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/plotDecontXMarkerExpression-1.png" width="700"></p>
<p>Some helpful hints when using
<code>plotDecontXMarkerExpression</code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>groupClusters</code> works the same way as in
<code>plotDecontXMarkerPercentage</code>.</li>
<li>This function will plot each pair of markers and clusters (or cell
type specified by <code>groupClusters</code>). Therefore, you may want
to keep the number of markers small in each plot and call the function
multiple times for different sets of marker genes.</li>
<li>You can also plot the individual points by setting
<code>plotDots = TRUE</code> and/or log transform the points on the fly
by setting <code>log1p = TRUE</code>.</li>
<li>This function can plot any assay in a
<code>SingleCellExperiment</code>. Therefore you could also examine
normalized expression of the original and decontaminated counts. For
example:</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">logNormCounts</a></span><span class="op">(</span><span class="va">sce</span>,</span>
<span>    exprs_values <span class="op">=</span> <span class="st">"decontXcounts"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"decontXlogcounts"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotDecontXMarkerExpression.html">plotDecontXMarkerExpression</a></span><span class="op">(</span><span class="va">sce</span>,</span>
<span>    markers <span class="op">=</span> <span class="va">markers</span><span class="op">[[</span><span class="st">"Monocyte_Markers"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    groupClusters <span class="op">=</span> <span class="va">cellTypeMappings</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    assayName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logcounts"</span>, <span class="st">"decontXlogcounts"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/plot_norm_counts-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="other-important-notes">Other important notes<a class="anchor" aria-label="anchor" href="#other-important-notes"></a>
</h2>
<div class="section level3">
<h3 id="choosing-appropriate-cell-clusters">Choosing appropriate cell clusters<a class="anchor" aria-label="anchor" href="#choosing-appropriate-cell-clusters"></a>
</h3>
<p>The ability of DecontX to accurately identify contamination is
dependent on the cell cluster labels. DecontX assumes that contamination
for a cell cluster comes from combination of counts from all other
clusters. The default clustering approach used by DecontX tends to
select fewer clusters that represent broader cell types. For example,
all T-cells tend to be clustered together rather than splitting naive
and cytotoxic T-cells into separate clusters. Custom cell type labels
can be suppled via the <code>z</code> parameter if some cells are not
being clustered appropriately by the default method.</p>
</div>
<div class="section level3">
<h3 id="adjusting-the-priors-to-influence-contamination-estimates">Adjusting the priors to influence contamination estimates<a class="anchor" aria-label="anchor" href="#adjusting-the-priors-to-influence-contamination-estimates"></a>
</h3>
<p>There are ways to force <code>decontX</code> to estimate more or less
contamination across a dataset by manipulating the priors. The
<code>delta</code> parameter is a numeric vector of length two. It is
the concentration parameter for the Dirichlet distribution which serves
as the prior for the proportions of native and contamination counts in
each cell. The first element is the prior for the proportion of native
counts while the second element is the prior for the proportion of
contamination counts. These essentially act as pseudocounts for the
native and contamination in each cell. If
<code>estimateDelta = TRUE</code>, <code>delta</code> is only used to
produce a random sample of proportions for an initial value of
contamination in each cell. Then <code>delta</code> is updated in each
iteration. If <code>estimateDelta = FALSE</code>, then
<code>delta</code> is fixed with these values for the entire inference
procedure. Fixing <code>delta</code> and setting a high number in the
second element will force <code>decontX</code> to be more aggressive and
estimate higher levels of contamination in each cell at the expense of
potentially removing native expression. For example, in the previous
PBMC example, we can see what the estimated <code>delta</code> was by
looking in the estimates:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">metadata</span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">$</span><span class="va">decontX</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">all_cells</span><span class="op">$</span><span class="va">delta</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 9.281387 1.037596</span></span></code></pre>
<p>Setting a higher value in the second element of delta and
<code>estimateDelta = FALSE</code> will force <code>decontX</code> to
estimate higher levels of contamination per cell:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce.delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decontX.html">decontX</a></span><span class="op">(</span><span class="va">sce</span>, delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">20</span><span class="op">)</span>, estimateDelta <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sce</span><span class="op">$</span><span class="va">decontX_contamination</span>, <span class="va">sce.delta</span><span class="op">$</span><span class="va">decontX_contamination</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"DecontX estimated priors"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Setting priors to estimate higher contamination"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="decontX_files/figure-html/newDecontX-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="seurat">Working with Seurat<a class="anchor" aria-label="anchor" href="#seurat"></a>
</h3>
<p>If you are using the <a href="https://cran.r-project.org/web/packages/Seurat/index.html" class="external-link">Seurat</a>
package for downstream analysis, the following code can be used to read
in a matrix and convert between Seurat and SCE objects:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read counts from CellRanger output</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/Read10X.html" class="external-link">Read10X</a></span><span class="op">(</span><span class="st">"sample/outs/filtered_feature_bc_matrix/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a SingleCellExperiment object and run decontX</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">counts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decontX.html">decontX</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a Seurat object from a SCE with decontX results</span></span>
<span><span class="va">seuratObject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/decontXcounts.html">decontXcounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Optionally, the “raw” matrix can be also be imported and used as the
background:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts.raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/Read10X.html" class="external-link">Read10X</a></span><span class="op">(</span><span class="st">"sample/outs/raw_feature_bc_matrix/"</span><span class="op">)</span></span>
<span><span class="va">sce.raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">counts.raw</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decontX.html">decontX</a></span><span class="op">(</span><span class="va">sce</span>, background <span class="op">=</span> <span class="va">sce.raw</span><span class="op">)</span></span></code></pre></div>
<p>Note that the decontaminated matrix of decontX consists of floating
point numbers and must be rounded to integers before adding it to a
Seurat object. If you already have a Seurat object containing the counts
matrix and would like to run decontX, you can retrieve the count matrix,
create a SCE object, and run decontX, and then add it back to the Seurat
object:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/AssayData.html" class="external-link">GetAssayData</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">seuratObject</span>, slot <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">counts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decontX.html">decontX</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span><span class="va">seuratObj</span><span class="op">[[</span><span class="st">"decontXcounts"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateAssayObject.html" class="external-link">CreateAssayObject</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="fu"><a href="../reference/decontXcounts.html">decontXcounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.0 (2022-04-22)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Big Sur/Monterey 10.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib</span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] scater_1.24.0               ggplot2_3.3.6              </span></span>
<span><span class="co">##  [3] scuttle_1.6.3               TENxPBMCData_1.14.0        </span></span>
<span><span class="co">##  [5] HDF5Array_1.24.2            rhdf5_2.40.0               </span></span>
<span><span class="co">##  [7] DelayedArray_0.22.0         celda_1.13.0               </span></span>
<span><span class="co">##  [9] Matrix_1.4-1                SingleCellExperiment_1.18.0</span></span>
<span><span class="co">## [11] SummarizedExperiment_1.26.1 Biobase_2.56.0             </span></span>
<span><span class="co">## [13] GenomicRanges_1.48.0        GenomeInfoDb_1.32.3        </span></span>
<span><span class="co">## [15] IRanges_2.30.1              S4Vectors_0.34.0           </span></span>
<span><span class="co">## [17] BiocGenerics_0.42.0         MatrixGenerics_1.8.1       </span></span>
<span><span class="co">## [19] matrixStats_0.62.0          BiocStyle_2.24.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] AnnotationHub_3.4.0           BiocFileCache_2.4.0          </span></span>
<span><span class="co">##   [3] systemfonts_1.0.4             RcppEigen_0.3.3.9.2          </span></span>
<span><span class="co">##   [5] plyr_1.8.7                    assertive.files_0.0-2        </span></span>
<span><span class="co">##   [7] enrichR_3.1                   multipanelfigure_2.1.2       </span></span>
<span><span class="co">##   [9] BiocParallel_1.30.3           digest_0.6.29                </span></span>
<span><span class="co">##  [11] foreach_1.5.2                 htmltools_0.5.3              </span></span>
<span><span class="co">##  [13] viridis_0.6.2                 magick_2.7.3                 </span></span>
<span><span class="co">##  [15] fansi_1.0.3                   magrittr_2.0.3               </span></span>
<span><span class="co">##  [17] memoise_2.0.1                 ScaledMatrix_1.4.0           </span></span>
<span><span class="co">##  [19] assertive.numbers_0.0-2       doParallel_1.0.17            </span></span>
<span><span class="co">##  [21] Biostrings_2.64.1             pkgdown_2.0.6                </span></span>
<span><span class="co">##  [23] colorspace_2.0-3              blob_1.2.3                   </span></span>
<span><span class="co">##  [25] rappdirs_0.3.3                ggrepel_0.9.1                </span></span>
<span><span class="co">##  [27] textshaping_0.3.6             xfun_0.32                    </span></span>
<span><span class="co">##  [29] dplyr_1.0.10                  crayon_1.5.1                 </span></span>
<span><span class="co">##  [31] RCurl_1.98-1.8                jsonlite_1.8.0               </span></span>
<span><span class="co">##  [33] iterators_1.0.14              glue_1.6.2                   </span></span>
<span><span class="co">##  [35] gtable_0.3.1                  zlibbioc_1.42.0              </span></span>
<span><span class="co">##  [37] XVector_0.36.0                BiocSingular_1.12.0          </span></span>
<span><span class="co">##  [39] Rhdf5lib_1.18.2               scales_1.2.1                 </span></span>
<span><span class="co">##  [41] DBI_1.1.3                     Rcpp_1.0.9                   </span></span>
<span><span class="co">##  [43] viridisLite_0.4.1             xtable_1.8-4                 </span></span>
<span><span class="co">##  [45] gridGraphics_0.5-1            rsvd_1.0.5                   </span></span>
<span><span class="co">##  [47] bit_4.0.4                     httr_1.4.4                   </span></span>
<span><span class="co">##  [49] RColorBrewer_1.1-3            ellipsis_0.3.2               </span></span>
<span><span class="co">##  [51] farver_2.1.1                  pkgconfig_2.0.3              </span></span>
<span><span class="co">##  [53] sass_0.4.2                    uwot_0.1.14                  </span></span>
<span><span class="co">##  [55] dbplyr_2.2.1                  utf8_1.2.2                   </span></span>
<span><span class="co">##  [57] labeling_0.4.2                tidyselect_1.1.2             </span></span>
<span><span class="co">##  [59] rlang_1.0.5                   reshape2_1.4.4               </span></span>
<span><span class="co">##  [61] later_1.3.0                   AnnotationDbi_1.58.0         </span></span>
<span><span class="co">##  [63] munsell_0.5.0                 BiocVersion_3.15.2           </span></span>
<span><span class="co">##  [65] tools_4.2.0                   cachem_1.0.6                 </span></span>
<span><span class="co">##  [67] cli_3.3.0                     dbscan_1.1-10                </span></span>
<span><span class="co">##  [69] generics_0.1.3                RSQLite_2.2.16               </span></span>
<span><span class="co">##  [71] ExperimentHub_2.4.0           evaluate_0.16                </span></span>
<span><span class="co">##  [73] stringr_1.4.1                 fastmap_1.1.0                </span></span>
<span><span class="co">##  [75] yaml_2.3.5                    ragg_1.2.2                   </span></span>
<span><span class="co">##  [77] knitr_1.40                    bit64_4.0.5                  </span></span>
<span><span class="co">##  [79] fs_1.5.2                      purrr_0.3.4                  </span></span>
<span><span class="co">##  [81] KEGGREST_1.36.3               sparseMatrixStats_1.8.0      </span></span>
<span><span class="co">##  [83] mime_0.12                     compiler_4.2.0               </span></span>
<span><span class="co">##  [85] rstudioapi_0.14               beeswarm_0.4.0               </span></span>
<span><span class="co">##  [87] filelock_1.0.2                curl_4.3.2                   </span></span>
<span><span class="co">##  [89] png_0.1-7                     interactiveDisplayBase_1.34.0</span></span>
<span><span class="co">##  [91] tibble_3.1.8                  bslib_0.4.0                  </span></span>
<span><span class="co">##  [93] stringi_1.7.8                 highr_0.9                    </span></span>
<span><span class="co">##  [95] desc_1.4.1                    lattice_0.20-45              </span></span>
<span><span class="co">##  [97] assertive.base_0.0-9          vctrs_0.4.1                  </span></span>
<span><span class="co">##  [99] pillar_1.8.1                  lifecycle_1.0.1              </span></span>
<span><span class="co">## [101] rhdf5filters_1.8.0            BiocManager_1.30.18          </span></span>
<span><span class="co">## [103] combinat_0.0-8                jquerylib_0.1.4              </span></span>
<span><span class="co">## [105] RcppAnnoy_0.0.19              BiocNeighbors_1.14.0         </span></span>
<span><span class="co">## [107] irlba_2.3.5                   data.table_1.14.2            </span></span>
<span><span class="co">## [109] bitops_1.0-7                  httpuv_1.6.5                 </span></span>
<span><span class="co">## [111] assertive.types_0.0-3         R6_2.5.1                     </span></span>
<span><span class="co">## [113] bookdown_0.28                 assertive.properties_0.0-5   </span></span>
<span><span class="co">## [115] promises_1.2.0.1              gridExtra_2.3                </span></span>
<span><span class="co">## [117] vipor_0.4.5                   codetools_0.2-18             </span></span>
<span><span class="co">## [119] MCMCprecision_0.4.0           assertthat_0.2.1             </span></span>
<span><span class="co">## [121] rprojroot_2.0.3               rjson_0.2.21                 </span></span>
<span><span class="co">## [123] withr_2.5.0                   GenomeInfoDbData_1.2.8       </span></span>
<span><span class="co">## [125] parallel_4.2.0                grid_4.2.0                   </span></span>
<span><span class="co">## [127] beachmat_2.12.0               rmarkdown_2.16               </span></span>
<span><span class="co">## [129] DelayedMatrixStats_1.18.0     Rtsne_0.16                   </span></span>
<span><span class="co">## [131] shiny_1.7.2                   ggbeeswarm_0.6.0</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joshua Campbell, Shiyi Yang, Zhe Wang, Sean Corbett, Yusuke Koga.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
